Kerberos 是一种网络身份验证协议，主要由三个部分组成：客户端（Client）、服务端（Server）和密钥分发中心（KDC）。KDC 包含两个主要组件：认证服务（AS）和票据授予服务（TGS）。以下是 Kerberos 的基本工作流程：

1. 客户端获取 TGT：

	- 客户端向 KDC 的 AS 发送认证请求（AS_REQ），请求中包含客户端的身份信息。

	- AS 验证客户端身份后，生成一个会话密钥和一个 TGT（Ticket Granting Ticket），并将它们发送给客户端（AS_REP）。

	- 客户端使用自己的密钥解密 AS_REP，获取会话密钥和 TGT。

1. 客户端请求服务票据（Service Ticket）：

	- 客户端使用 TGT 向 KDC 的 TGS 发送请求（TGS_REQ），请求访问特定服务。

	- TGS 验证 TGT 后，生成一个服务票据（Service Ticket），并将它发送给客户端（TGS_REP）。

1. 客户端访问服务：

	- 客户端将服务票据发送给目标服务端。

	- 服务端验证服务票据后，允许客户端访问服务。

具体步骤如下：

1. 客户端获取 TGT：

	- 客户端使用 **kinit** 命令或其他 Kerberos 客户端工具向 KDC 的 AS 发送请求。

	- AS 验证客户端身份后，返回 TGT 和会话密钥。

1. 客户端请求服务票据：

	- 客户端使用 TGT 向 TGS 发送请求，获取服务票据。

	- TGS 验证 TGT 后，返回服务票据。

1. 客户端访问服务：

	- 客户端将服务票据发送给服务端，服务端验证后允许访问。

### 在 AWS EC2 上设置 Kerberos 集群

1. 创建安全配置：定义 Kerberos 属性，如 KDC 详细信息。

1. 创建 EMR 集群：指定安全配置和 Kerberos 选项。

1. 配置主节点：确保每个 Kerberos 用户在主节点上有对应的 Linux 账户。
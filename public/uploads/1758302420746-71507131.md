# OneNote BlackNote

一个基于本地Markdown文件的笔记管理与搜索应用，类似于Obsidian的开源替代方案。

## 功能特性

- 📝 **本地Markdown笔记管理** - 直接读取和编辑本地Markdown文件
- 📁 **文件夹结构支持** - 支持完整的文件夹组织结构
- 🔍 **全文搜索** - 强大的全文搜索功能，支持文件名和内容搜索
- ✏️ **富文本编辑** - 使用BlockNote编辑器提供丰富的编辑体验
- 🎨 **语法高亮** - 集成Shiki提供代码块语法高亮
- 🚀 **实时预览** - 编辑时实时预览Markdown内容

## 技术栈

- **前端**: React 18 + TypeScript + Vite
- **富文本编辑器**: BlockNote
- **语法高亮**: Shiki
- **状态管理**: React Context API + useReducer
- **后端**: Node.js + Express 5
- **构建工具**: TypeScript + Vite

## 系统架构

```mermaid
graph TD
    A[用户界面] --> B[应用状态管理]
    B --> C[文件系统API]
    B --> D[本地存储(localStorage)]
    C --> E[notes-md目录]
    D --> F[应用数据(笔记状态等)]
    B --> G[搜索引擎]
    G --> H[索引数据库]
```

## 核心功能

### 1. 笔记管理
- 读取本地`notes-md`目录中的所有Markdown文件
- 支持文件夹和文件的层级结构展示
- 实时编辑和保存功能

### 2. 搜索功能
- 文件名搜索（权重最高）
- 内容关键词匹配
- 搜索结果按相关性排序

### 3. 安全设计
- 防止路径遍历攻击
- 仅允许访问`notes-md`目录下的文件
- 文件扩展名验证（仅允许.md文件）

## 项目结构

```
.
├── notes-md/           # 本地Markdown笔记目录
├── src/
│   ├── components/     # React组件
│   ├── context/        # 应用状态管理
│   ├── server/         # 后端API服务
│   ├── utils/          # 工具函数
│   └── ...
├── package.json        # 项目依赖和脚本
└── README.md           # 项目文档
```

## 快速开始

### 环境要求
- Node.js 16+
- npm 或 yarn

### 安装依赖
```bash
npm install
```

### 开发模式
```bash
npm run dev
```

这将同时启动：
- 前端开发服务器 (http://localhost:5173)
- 后端API服务器 (http://localhost:3001)

### 生产构建
```bash
npm run build
```

### 预览生产构建
```bash
npm run preview
```

## API接口

### 笔记管理
- `GET /api/notes` - 获取所有笔记文件列表
- `GET /api/notes/:filePath` - 读取单个笔记内容
- `POST /api/notes/:filePath` - 保存笔记内容

### 搜索功能
- `GET /api/search?q=query` - 搜索笔记
- `POST /api/search/rebuild` - 重建搜索索引

## 使用说明

1. 将您的Markdown笔记文件放置在`notes-md`目录中
2. 启动应用后，左侧边栏将显示文件结构
3. 点击文件即可在右侧编辑器中查看和编辑
4. 使用顶部搜索框进行全文搜索

## 许可证

MIT